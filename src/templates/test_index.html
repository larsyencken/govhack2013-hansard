<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/htmll 4/strict.dtd">
<html>
<head>
<title>Hansard hack</title>
<style>

text {
  font: 10px sans-serif;
}

table
{
border-collapse:collapse;
}
table,th, td
{
border: 1px solid gray;
}

</style>
<!-- Speakers -->

<script src="/bubble/{{speakerid}}/words.js"></script>

<!--http://www.infocaptor.com-->
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://code.jquery.com/jquery-latest.min.js"         type="text/javascript"></script>

<script>
   $(document).ready(function ()
	   {

var page_text='URL not provided or maybe content is behind https';
//alert(page_text);
var diameter = 1000 - 30,
    limit=10000,
    format = d3.format(",d"),
    color = d3.scale.category20c();

var bubble = d3.layout.pack()
    .sort(null)
    .size([diameter, diameter])
    .padding(1.5);

var svg = d3.select("#svgid").append("svg")
    .attr("width", diameter)
    .attr("height", diameter)
    .attr("class", "bubble");

/*
 * var data=[
["Tea","Coffee","Soda","Chips","Milk","Chocolate","Beer","Wine","Tobacco","gold","silver"],
[130,30,200,40,230,150,80,65,20,10,100]
];
*/

var dobj=[];

for (var di=0;di<data[0].length;di++)
{
  dobj.push({"key":di,"value":data[1][di]});
}
	display_pack({children: dobj});

//d3.json("flare.json", function(error, root)
function display_pack(root)
{
  var node = svg.selectAll(".node")
      .data(bubble.nodes(root)
      .filter(function(d) { return !d.children; }))
    .enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; })
	  .style("fill", function(d) { return color(data[0][d.value]); })
	  	.on("mouseover", function(d,i)
	{
		d3.select(this).style("fill", "gold");
		showToolTip(" "+data[0][i]+"<br>"+data[1][i]+" ",d.x+d3.mouse(this)[0]+50,d.y+d3.mouse(this)[1],true);
		//console.log(d3.mouse(this));
	})
	.on("mousemove", function(d,i)
	{

		tooltipDivID.css({top:d.y+d3.mouse(this)[1],left:d.x+d3.mouse(this)[0]+50});
		//showToolTip("<ul><li>"+data[0][i]+"<li>"+data[1][i]+"</ul>",d.x+d3.mouse(this)[0]+10,d.y+d3.mouse(this)[1]-10,true);
		//console.log(d3.mouse(this));
	})
    .on("mouseout", function()
	{
		d3.select(this).style("fill", function(d) { return color(data[0][d.key]); });
		showToolTip(" ",0,0,false);
	})
	;

  /*node.append("title")
      .text(function(d) { return data[0][d.key] + ": " + format(d.value); });
*/
  node.append("circle")
      .attr("r", function(d) { return d.r; })
	  ;
      //.style("fill", function(d) { return color(data[0][d.key]); });

  node.append("text")
      .attr("dy", ".3em")
      .style("text-anchor", "middle")
	  .style("fill","black")
      .text(function(d) { return data[0][d.key].substring(0, d.r / 3); });
}
//);

function showToolTip(pMessage,pX,pY,pShow)
{
  if (typeof(tooltipDivID)=="undefined")
  {
             tooltipDivID =$('<div id="messageToolTipDiv" style="position:absolute;display:block;z-index:10000;border:2px solid black;background-color:rgba(0,0,0,0.8);margin:auto;padding:3px 5px 3px 5px;color:white;font-size:12px;font-family:arial;border-radius: 5px;vertical-align: middle;text-align: center;min-width:50px;overflow:auto;"></div>');

		$('body').append(tooltipDivID);
  }
  if (!pShow) { tooltipDivID.hide(); return;}
  //MT.tooltipDivID.empty().append(pMessage);
  tooltipDivID.html(pMessage);
  tooltipDivID.css({top:pY,left:pX});
  tooltipDivID.show();
}

//d3.select(self.frameElement).style("height", diameter + "px");

}
) //document ready

</script>

</head>
<body style="font-family:arial;">
<h1 style="text-align: center">{{name}}</h1>
<div align="center">
<p> Word frequency bubble chart for speaker {{speakerid}}. Hover over the bubble to highlight the word and view the frequency of use.</p>
<!--
<div id="infobox" style="color:gray;font-size:14px;">[<span id="urlbox" style=""><a href="" rel="nofollow" ></a></span>], No of Characters: , Number of words:<span id="countbox">3342</span></div>
-->
<!--a class="addthis_counter addthis_bubble_style"></a-->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=xa-511ab711513fbf8f"></script>
<!-- AddThis Button END -->

<div id="svgid">
</div>

<div id="word_list">
</div>

<p> Based on Australian Government Hansard data - this application was created as part of GovHack 2013 </p>
</div>
</body>
</html>
